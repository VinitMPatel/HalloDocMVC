@* @page
@model HalloDoc.Views.Admin.AdminDashboardModel
@{
} *@
<Partial name="_Notification" />
@model Services.ViewModels.AdminDashboard
@{
    Layout = "_Admin";
}
<div id="viewCaseContent">
    <nav>
        <div class="nav nav-tabs row mt-3 mx-1 pb-2" id="status-tab" role="tablist">
            <div class="allstatus p-1">
                <button class="w-100 nav-link dashboardtab active position-relative p-0" id="status-new" data-bs-toggle="tab" data-bs-target="#s_new" type="button" role="tab" aria-controls="s_new" aria-selected="true">
                    <div class="p-2 new rounded">
                        <div class="d-flex">
                            <div class="px-2 icons float-start small"><i class="bi bi-plus-circle-dotted"></i></div><div class="small fw-bold">NEW</div>
                        </div>
                        <div class="fw-bolder fs-4 p-2 text-start">@Model.requestclients.Where(a => a.Request.Status == 1).Count()</div>
                    </div>
                    <div class="bottomarrow"></div>
                </button>
            </div>
            <div class="allstatus p-1">
                <button class="nav-link dashboardtab position-relative w-100 p-0" id="status-pending" data-bs-toggle="tab" data-bs-target="#s_pending" type="button" role="tab" aria-controls="s_pending" aria-selected="false">
                    <div class="p-2 pending rounded-2">
                        <div class="d-flex">
                            <div class="px-2 icons float-start small"><i class="bi bi-plus-circle-dotted"></i></div><div class="small fw-bold">PENDING</div>
                        </div>
                        <div class="fw-bolder fs-4 p-2 text-start">@Model.requestclients.Where(a => a.Request.Status == 2).Count()</div>
                    </div>
                    <div class="bottomarrow"></div>
                </button>
            </div>
            <div class="allstatus p-1">
                <button class="nav-link dashboardtab position-relative w-100 p-0" id="status-active" data-bs-toggle="tab" data-bs-target="#s_active" type="button" role="tab" aria-controls="s_active" aria-selected="false">
                    <div class="p-2 activecase rounded-2">
                        <div class="d-flex">
                            <div class="px-2 icons  float-start small"><i class="bi bi-plus-circle-dotted"></i></div><div class="small fw-bold">ACTIVE</div>
                        </div>
                        <div class="fw-bolder fs-4 p-2 text-start">@Model.requestclients.Where(a => a.Request.Status == 4 || a.Request.Status == 5).Count()</div>
                    </div>
                    <div class="bottomarrow"></div>
                </button>
            </div>
            <div class="allstatus p-1">
                <button class="nav-link dashboardtab position-relative w-100 p-0" id="status-conclude" data-bs-toggle="tab" data-bs-target="#s_conclude" type="button" role="tab" aria-controls="s_conclude" aria-selected="false">
                    <div class="p-2 conclude rounded-2">
                        <div class="d-flex">
                            <div class="px-1  icons float-start small"><i class="bi bi-plus-circle-dotted"></i></div><div class="small fw-bold">CONCLUDE</div>
                        </div>
                        <div class="fw-bolder fs-4 p-2 text-start">@Model.requestclients.Where(a => a.Request.Status == 6).Count()</div>
                    </div>
                    <div class="bottomarrow"></div>
                </button>
            </div>
            <div class="allstatus p-1">
                <button class="nav-link dashboardtab position-relative w-100 p-0" id="status-toclose" data-bs-toggle="tab" data-bs-target="#s_toclose" type="button" role="tab" aria-controls="s_toclose" aria-selected="false">
                    <div class="p-2 toclose rounded-2">
                        <div class="d-flex">
                            <div class="px-2 icons  float-start small"><i class="bi bi-plus-circle-dotted"></i></div><div class="small fw-bold">TO CLOSE</div>
                        </div>
                        <div class="fw-bolder fs-4 p-2 text-start">@Model.requestclients.Where(a => a.Request.Status == 3 || a.Request.Status == 7 || a.Request.Status == 8).Count()</div>
                    </div>
                    <div class="bottomarrow"></div>
                </button>
            </div>
            <div class="allstatus p-1">
                <button class="nav-link dashboardtab position-relative w-100 p-0" id="status-unpaid" data-bs-toggle="tab" data-bs-target="#s_unpaid" type="button" role="tab" aria-controls="s_unpaid" aria-selected="false">
                    <div class="p-2 unpaid rounded-2">
                        <div class="d-flex">
                            <div class="px-2 icons  float-start small"><i class="bi bi-plus-circle-dotted"></i></div><div class="small fw-bold">UNPAID</div>
                        </div>
                        <div class="fw-bolder fs-4 p-2 text-start">@Model.requestclients.Where(a => a.Request.Status == 9).Count()</div>
                    </div>
                    <div class="bottomarrow"></div>
                </button>
            </div>
        </div>
    </nav>

    <div class="d-flex justify-content-between mt-5 mx-4">

        <div>
            <div class="h3">Patient <span class="text-info">(New)</span></div>
        </div>
        <div>
            <a class="text-decoration-none btn btn-info text-white" type="button">
                <i class="bi bi-send me-2 "></i>
                <span class="dash-btn">Send Link</span>
            </a>
            <a class="text-decoration-none btn btn-info text-white" type="button">
                <i class="bi bi-file-text me-2 "></i>
                <span class="dash-btn">Create Requests</span>
            </a>
            <a class="text-decoration-none btn btn-info text-white" type="button">
                <i class="bi bi-arrow-up-short me-2"></i>
                <span class="dash-btn">Export</span>
            </a>
            <a class="text-decoration-none btn btn-info text-white mt-1 mt-sm-0" type="button">
                <i class="bi bi-arrow-bar-up me-2 "></i>
                <span class="dash-btn">Export All</span>
            </a>
            <a class="text-decoration-none btn btn-info text-white mt-1 mt-sm-0" type="button">
                <i class="bi bi-pin-map me-2"></i>
                <span class="dash-btn">Request DTY Support</span>
            </a>
        </div>
    </div>

    <div class="border rounded-4 mx-4 mt-4">
    <div class="d-lg-flex justify-content-between py-3 mx-3 flex-wrap">
        <div class="dropdown d-flex flex-wrap row">

            <div class="col-12 col-sm-6">
                <div class="d-flex rounded-2 border border-dark h-100">
                    <span class="search-icon"></span>
                    <input id="search" onkeyup="Search()" class="form-control form-control-sm border-0 shadow-none p-0" type="search" placeholder="Search Patients" aria-label="Search">
                </div>
            </div>

            <div class="col-12 col-sm-6 mt-3 mt-sm-0">
                <button class="btn bg-white border border-dark dropdown-toggle w-100 h-100" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fa-solid fa-magnifying-glass fa-xs"></i> <label class="me-4">All Region</label>
                </button>
                <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#">Action</a></li>
                    <li><a class="dropdown-item" href="#">Another action</a></li>
                    <li><a class="dropdown-item" href="#">Something else here</a></li>
                </ul>
            </div>

        </div>

        <div class="d-flex flex-wrap mt-2">

            <div class="d-flex justify-content-center align-items-center px-2 filter" onclick="filter(0)">
                <input type="radio" class="btn-check" name="requestby" id="requestbyAll" autocomplete="off">
                <label class="btn border rounded-2 px-3" for="requestbyAll">All</label>
            </div>
            <div class="d-flex justify-content-center align-items-center px-2 filter" id="1" onclick="filter(1)">
                <input type="radio" class="btn-check" name="requestby" autocomplete="off"><i class="bi bi-circle-fill" style="color :#5fbc61"></i>
                <label class="btn p-1 border-0 d-block" for="1">Patient</label>
            </div>
            <div class="d-flex justify-content-center align-items-center px-2 filter" id="2" onclick="filter(2)">
                <input type="radio" class="btn-check" name="requestby" autocomplete="off"><i class="bi bi-circle-fill" style="color:  #ed9124;"></i>
                <label class="btn p-1 border-0 text-small" for="2">Family</label>
            </div>
            <div class="d-flex justify-content-center align-items-center px-2 filter" id="3" onclick="filter(3)">
                <input type="radio" class="btn-check" name="requestby" autocomplete="off"><i class="bi bi-circle-fill" style="color:#e36478;"></i>
                <label class="btn p-1 border-0" for="3">Concierge</label>
            </div>
            <div class="d-flex justify-content-center align-items-center px-2 filter" id="4" onclick="filter(4)">
                <input type="radio" class="btn-check" name="requestby" autocomplete="off"><i class="bi bi-circle-fill" style="color:  #0c7db7;"></i>
                <label class="btn p-1 border-0" for="4">Business</label>
            </div>
            <div class="d-flex justify-content-center align-items-center px-2 filter" id="5" onclick="filter(5)">
                <input type="radio" class="btn-check" name="requestby" autocomplete="off"><i class="bi bi-circle-fill" style="color:  #943db8;"></i>
                <label class="btn p-1 border-0" for="5">VIP</label>
            </div>

        </div>
    </div>
    <div class="tab-content" id="status-tabContent">
        <div class="tab-pane fade show active" id="s_new" role="tabpanel" aria-labelledby="status-new">
        </div>
        <div class="tab-pane fade" id="s_pending" role="tabpanel" aria-labelledby="status-panding">
        </div>
        <div class="tab-pane fade" id="s_active" role="tabpanel" aria-labelledby="status-active">
        </div>
        <div class="tab-pane fade" id="s_conclude" role="tabpanel" aria-labelledby="status-conclude">
        </div>
        <div class="tab-pane fade" id="s_toclose" role="tabpanel" aria-labelledby="status-toclose">
        </div>
        <div class="tab-pane fade" id="s_unpaid" role="tabpanel" aria-labelledby="status-unpaid">
        </div>
        @* <partial name="_AssignCase" /> *@
    </div>
    </div>
</div>

<script>
    var currentPage = 1;
    var requestType;
    var requestStatus;
    var searchKey;
   
    function filter(type) {
        if (type == 0) {
            requestType = "0";
            requestStatus = requestStatus;
        }
        else {
            requestType = type;
            currentPage = 1;
        }
        CommonAjax();
    }

    function Search() {
        searchKey = $('#search').val();
        if (typeof (requestType) == "undefined") {
            requestType = "0";
        }
        if (typeof (requestStatus) == "undefined") {
            requestStatus = "0";
        }
        CommonAjax();
    }

    $(document).ready(function () {
        $.ajax({
            url: '/Admin/NewState',
            data: { "status": 1, "requesttype": 0},
            success: function (response) {
                requestStatus = 1;
                $('#status-tabContent').html(response);
            },
            error: function (xhr, status, error) {
                console.error(error);
            }
        });

        $('.dashboardtab').on('click', function (e) {
            e.preventDefault();
            
            //$('.dashboardtab').removeClass('active');
            //$(this).addClass('active');
            var target = $(this).data('bs-target');
            var url;
            switch (target) {
                case '#s_new':
                    url = '/Admin/NewState';
                    requestStatus = 1;
                    break;
                case '#s_pending':
                    requestStatus = 2;
                    url = '/Admin/NewState';
                    break;
                case '#s_active':
                    requestStatus = 4 ;
                    url = '/Admin/ActiveState';
                    break;
                case '#s_conclude':
                    requestStatus = 6;
                    url = '/Admin/ConcludeState';
                    break;
                case '#s_toclose':
                    requestStatus = 3;
                    url = '/Admin/ToCloseState';
                    break;
                case '#s_unpaid':
                    requestStatus = 9;
                    url = '/Admin/UnpaidState';
                    break;
                default:
                    url = 'Admin/AdminDashboard';
            }

            $.ajax({
                url: url,
                data: { "status": requestStatus, "requesttype": 0, "currentPage": 1 },
                success: function (response) {
                    $('#status-tabContent').html(response);
                },
                error: function (xhr, status, error) {
                    console.error(error);
                }
            });
        });
    });
</script>
