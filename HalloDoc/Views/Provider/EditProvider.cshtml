@model Services.ViewModels.EditProviderViewModel
@{
    Layout = "";
}
<Partial name="_Notification" />
<div class="modal fade" id="ModalToOpen" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
    <div class="modal-dialog " role="document">
        <div class="modal-content">
            <div class="p-4 m-auto border border-1 border-info rounded-2">
                <div class="row">
                    <div class="col-md-12">
                        <h1>E-Signature</h1>
                        <p>Sign in the canvas below and save your signature as an image!</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <canvas class="border border-secondary rounded-2" id="sig-canvas" width="300" height="160">
                            This Browser is not supported.
                        </canvas>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <button class="p-2 px-3 text-white bg-info rounded border-info  mx-2 px-3 shadow-none" id="sig-submitBtn" onclick="convertCanvasToImage()" data-bs-dismiss="modal">Submit Signature</button>
                        <button class="btn border-info text-info shadow-none" id="sig-clearBtn">Clear Signature</button>
                    </div>
                </div>
                <div class="d-flex justify-content-end">
                    <button type="button" id="Cancelbutton" class="btn border-info text-info shadow-none" data-bs-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="d-flex justify-content-between">
    <div class="fw-bolder h4">Edit Physician Account</div>
    <div>
        <button class=" border border-info rounded-2 p-2 bg-transparent">
            <a class="text-decoration-none text-info" asp-action="Provider">&lt; Back</a>
        </button>
    </div>
</div>

<div class="border rounded-3 p-3 mt-4 bg-transparent" id="main-content">

    <div class="row AccountInfo">
        <div class="h4">Account Information</div>

        <div class="p-2 col-sm-6 col-12">
            <div class="form-floating ">
                <input type="text" class="form-control" placeholder="User Name" name="contact" disabled>
                <label class="FloatingInput">User Name</label>
            </div>
        </div>

        <div class="p-2 col-sm-6 col-12">
            <div class="form-floating ">
                <input type="password" class="form-control" placeholder="Password">
                <label class="FloatingInput">Password</label>
            </div>
        </div>

        <div class="col-sm-6 col-12 p-2">
            <div class="form-floating">
                <select class="form-select businesses" aria-label="Floating label select example" id="floatingSelect" disabled>
                    <option value="" selected>Active</option>
                </select>
                <label for="floatingSelect">Status</label>
            </div>
        </div>

        <div class="col-sm-6 col-12 p-2">
            <div class="form-floating">
                <select class="form-select businesses" aria-label="Floating label select example" id="floatingSelect" disabled>
                    <option value="" selected>Master Admin</option>
                </select>
                <label for="floatingSelect">Role</label>
            </div>
        </div>

        <div class="d-flex justify-content-end gap-2 mt-4">
            <button type="button" class="btn bg-tranparent border-info text-info">Reset Password</button>
        </div>
    </div>
    <form id="myform1">
        <input type="text" asp-for="providerId" id="providerId" hidden/>
        <div class="row mt-3">

            <div class="h4">Physician Information</div>

            <div class="p-2 col-sm-6 col-12">
                <div class="form-floating ">
                    <input type="text" class="form-control data1" placeholder="First Name" disabled id="firstName" asp-for="firstName">
                    <label class="FloatingInput">First Name</label>
                </div>
                <span asp-validation-for="firstName" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12">
                <div class="form-floating ">
                    <input type="text" class="form-control data1" placeholder="Last Name" disabled id="lastName" asp-for="lastName">
                    <label class="FloatingInput">Last Name</label>
                </div>
                <span asp-validation-for="lastName" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12 ">
                <div class="form-floating ">
                    <input type="email" class="form-control data1" placeholder="name@example.com" disabled id="email" asp-for="email">
                    <label class="FloatingInput">Email</label>
                    <span asp-validation-for="email" class="text-danger"></span>
                </div>
            </div>

            <div class="p-2 col-xl-6 col-sm-6 col-12">
                <div class="form-floating">
                    <input class="form-control data1" type="text" maxlength="10" placeholder="contact" disabled id="contact" asp-for="contactNumber" />
                    <label class="floatingInput">Contact</label>
                    <span asp-validation-for="contactNumber" class="text-danger"></span>
                </div>
            </div>

            <div class="p-2 col-sm-6 col-12 ">
                <div class="form-floating ">
                    <input type="text" class="form-control data1" placeholder="MedicalLicense" disabled asp-for="medicalLecense">
                    <label class="FloatingInput">Medical License # </label>
                </div>
                <span asp-validation-for="medicalLecense" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12 ">
                <div class="form-floating ">
                    <input type="text" class="form-control data1" placeholder="NPINumber" disabled asp-for="NPINumber">
                    <label class="FloatingInput">NPI number </label>
                </div>
                <span asp-validation-for="NPINumber" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12 ">
                <div class="form-floating ">
                    <input type="email" class="form-control data1" placeholder="name@example.com" disabled asp-for="syncEmail">
                    <label class="FloatingInput">Synchronization Email Address </label>
                </div>
                <span asp-validation-for="syncEmail" class="text-danger"></span>
            </div>

            <div class="col-12 col-sm-6 mt-3">
                @foreach (var item in Model.regionList)
                {
                    <div class="form-check form-check-inline ">
                        <input class="form-check-input adisabled adminselectedregion-adminprofile data1" type="checkbox" name="selectedRegion"
                        @if (Model.physicianRegionlist.Any(a => a.Regionid == item.Regionid))
                        {
                            @:checked
                        } value="@item.Regionid" disabled>
                        <label class="form-check-label" for="inlineCheckbox1">@item.Name</label>
                    </div>
                }
            </div>

            <div class="d-flex justify-content-end gap-2 mt-2">
                <button id="submitBtn1" type="button" class="btn btn-info text-white">Edit</button>
                <button id="saveBtn1" type="submit" class="btn btn-info text-white shadow-none">Save Changes</button>
                <button id="cancelBtn1" type="reset" class="btn btn-outline-info ms-1">Cancel</button>
            </div>
        </div>
    </form>

    <form id="myForm2">
        <input type="text" asp-for="providerId" id="providerId2" hidden/>
        <div class="row mt-3">
            <div class="h4">Mailing and billing information</div>

            <div class="p-2 col-sm-6 col-12">
                <div class="form-floating ">
                    <input type="text" class="form-control data2" placeholder="Address1" disabled id="address1" asp-for="address1">
                    <label class="FloatingInput">Address1</label>
                </div>
                <span asp-validation-for="address1" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12">
                <div class="form-floating ">
                    <input type="text" class="form-control data2" placeholder="Address2" disabled id="address2" asp-for="address2">
                    <label class="FloatingInput">Address2</label>
                </div>
                <span asp-validation-for="address2" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12 ">
                <div class="form-floating ">
                    <input type="" class="form-control data2" placeholder="city" disabled id="city" asp-for="city">
                    <label class="FloatingInput">City</label>
                </div>
                <span asp-validation-for="city" class="text-danger"></span>
            </div>

            <div class="col-sm-6 col-12 p-2">
                <div class="form-floating">
                    <select class="form-select" aria-label="Floating label select example" disabled>
                        <option value="" selected>Ahmedabad</option>
                    </select>
                    <label class="FloatingInput">State</label>
                    <span asp-validation-for="state" class="text-danger"></span>
                </div>
            </div>

            <div class="col-sm-6 col-12 p-2">
                <div class="form-floating ">
                    <input type="text" class="form-control data2" placeholder="Zip Code" disabled id="zip" asp-for="zipcode">
                    <label class="FloatingInput">Zip Code</label>
                </div>
                <span asp-validation-for="zipcode" class="text-danger"></span>
            </div>

            <div class="col-xl-6 col-sm-6 col-12 p-2">
                <div class="form-floating">
                    <input class="form-control data2" type="text" maxlength="10" placeholder="contact" disabled id="billingContact" asp-for="billingContact" />
                    <label class="floatingInput">Contact</label>
                </div>
                <span asp-validation-for="billingContact" class="text-danger"></span>
            </div>

            <div class="d-flex justify-content-end gap-2 mt-4">
                <button id="submitBtn2" type="button" class="btn btn-info text-white">Edit</button>
                <button id="saveBtn2" type="submit" class="btn btn-info text-white shadow-none">Save Changes</button>
                <button id="cancelBtn2" type="reset" class="btn btn-outline-info ms-1">Cancel</button>
            </div>
        </div>
    </form>

    <div class="row mt-3">

        <div class="h4">Provider Profile</div>

        <form class="row" id="myForm3" enctype="multipart/form-data">
            <div class="p-2 col-sm-6 col-12">
                <div class="form-floating ">
                    <input type="text" class="form-control data3" placeholder="BusinessName" disabled asp-for="businessName" id="businessName">
                    <label class="FloatingInput">Business Name</label>
                </div>
                <span asp-validation-for="businessName" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12">
                <div class="form-floating ">
                    <input type="text" class="form-control data3" placeholder="example.com" disabled asp-for="businessSite" id="businessSite">
                    <label class="FloatingInput">Business Site</label>
                </div>
                <span asp-validation-for="businessSite" class="text-danger"></span>
            </div>

            <div class="p-2 col-sm-6 col-12">
                <div class="row d-flex">
                    <div class="col-12 ">
                        <div class="form-group rounded d-flex align-items-center justify-content-between border border-1 bg-body-secondary">
                            <div class="px-3 table-responsive">
                                <input type="file" id="uploadPhoto" hidden asp-for="photo" class="data3" disabled />
                                <label role="button" for="uploadPhoto" id="photoLabel" class="choosenfile text-nowrap text-secondary">No item selected</label>
                            </div>
                            <button class="photoUploadBtn px-2 py-1 d-flex ms-1 border-1 rounded-2 shadow-none data3 toEnable" disabled type="button">
                                <div class="d-flex align-items-center shadow-none"><i class="bi bi-cloud-arrow-up p-2"></i><div class="d-none d-md-block">Upload</div></div>
                            </button>
                        </div>
                    </div>
                    <span id="photoError" class="text-danger"></span>
                </div>
            </div>

            <div class="col-sm-4 col-9 p-2">
                <div class="form-group rounded d-flex align-items-center justify-content-between border border-1 bg-body-secondary">
                    <div class="px-3 table-responsive">
                        <input type="file" id="uploadSign" hidden asp-for="signature" class="data3" disabled />
                        <label role="button" for="uploadSign" id="signLabel" class="choosenfile text-nowrap text-secondary">No item selected</label>
                    </div>
                    <button class="signUploadBtn px-2 py-1 d-flex ms-1 border-1 rounded-2 shadow-none data3 toEnable" disabled type="button">
                        <div class="d-flex align-items-center shadow-none"><i class="bi bi-cloud-arrow-up p-2"></i><div class="d-none d-md-block">Upload</div></div>
                    </button>
                </div>
                <span asp-validation-for="photo" class="text-danger"></span>
                <span id="signError" class="text-danger"></span>
            </div>

            <div class="col-sm-2 col-1 p-2">
                <button type="button" id="ModalToOpen" data-bs-target="#ModalToOpen" data-bs-toggle="modal" class="uploadbtn d-flex py-1 border-1 rounded-2 shadow-none data3 toEnable" disabled>
                    <div role="button" class="d-flex align-items-center">
                        <i class="bi bi-pencil-fill p-2"></i>
                        <div class="d-none d-md-block">Create</div>
                    </div>
                </button>
            </div>

            <div class="d-flex my-3">
                @if (Model.photoName != null)
                {
                    <div class="w-50 d-flex justify-content-center align-items-center photoDiv" style="object-fit:contain">
                        <img src="~/upload/@Model.photoName" style="width:25vw; height:25vh; object-fit:contain" id="photoImg" />
                    </div>
                }
                <div class="w-50 d-flex justify-content-center align-items-center uploadedPhotoDiv d-none" style="object-fit:contain">
                    <img src="" style="width:25vw; height:25vh; object-fit:contain" id="uploadedPhotoImg" />
                </div>
                @if (Model.signName != null)
                {
                    <div class="w-50 d-flex justify-content-center align-items-center signDiv">
                        <img src="~/upload/@Model.signName" style="width:25vw; height:25vh; object-fit:contain" id="signImg" />
                    </div>
                }
                <div class="w-50 d-flex justify-content-center align-items-center uploadedSignDiv d-none">
                    <img src="" style="width:25vw; height:25vh; object-fit:contain" id="uploadedSignImg" />
                </div>
            </div>

            <div class="col-12 mt-3">
                <div class="form-floating">
                    <textarea asp-for="adminnote" class="form-control shadow-none data3"
                              placeholder="Admin Notes"
                              style="height: 100px" disabled id="adminNote"></textarea>
                    <label for="floatingTextarea2">Admin Notes</label>
                    <span class="text-danger" asp-validation-for="adminnote"></span>
                </div>
            </div>

            <div class="d-flex justify-content-end gap-2 mt-4">
                <button id="submitBtn3" type="button" class="btn btn-info text-white">Edit</button>
                <button id="saveBtn3" type="button" class="btn btn-info text-white shadow-none">Save Changes</button>
                <button id="cancelBtn3" type="reset" class="btn btn-outline-info ms-1">Cancel</button>
            </div>
        </form>

        <hr class="my-2" />

        <h5>Onboarding</h5>

        <form id="myForm4" enctype="multipart/form-data">
            <div class="table-responsive small" style="font-weight: bold">
                <table>
                    <tr class="p-1">
                        <td class="p-2">
                            <input type="checkbox" class="form-check-input" disabled id="agreementDocCheck"
                            @if (Model.IsAgreementDoc)
                            {
                                @: checked
                            } />
                        </td>
                        <td class="p-2 px-3">
                            Independent Contractor Agreement
                        </td>
                        <td class="p-2">
                            <input type="file" hidden id="uploadAgreement" accept="application/pdf" asp-for="agreementDoc" />
                            <label for="uploadAgreement" class="btn btn-info shadow-none p-1">
                                <div class="d-flex align-items-center shadow-none text-white">
                                    <i class="bi bi-cloud-arrow-up p-1"></i><div class="d-none d-md-block">Upload</div>
                                </div>
                            </label>
                        </td>
                        @if (Model.IsAgreementDoc)
                        {
                            var name = Model.providerId + "_agreement.pdf";
                            <td class="p-2" id="agreementViewBtn">
                                <a href="~/upload/@name" class="text-decoration-none">
                                    <button type="button" class="p-1 px-2 text-white bg-info rounded border-info d-flex align-items-center h-100">
                                        <i class="bi bi-eye-fill"></i>
                                        <span class="d-none d-md-block ps-2">View</span>
                                    </button>
                                </a>
                            </td>
                        }
                        <td class="p-2 d-none" id="uploadedAgreementViewBtn">
                            <a href="" class="text-decoration-none">
                                <button type="button" class="p-1 px-2 text-white bg-info rounded border-info d-flex align-items-center h-100">
                                    <i class="bi bi-eye-fill"></i>
                                    <span class="d-none d-md-block ps-2">View</span>
                                </button>
                            </a>
                        </td>
                    </tr>
                    <tr class="p-1">
                        <td class="p-2">
                            <input type="checkbox" class="form-check-input" disabled id="backgroundDocCheck"
                            @if (Model.IsBackgroundDoc)
                            {
                                @: checked
                            } />
                        </td>
                        <td class="p-2 px-3">
                            Background Check
                        </td>
                        <td class="p-2">
                            <input type="file" hidden id="uploadBackground" accept="application/pdf" asp-for="backgroundDoc" />
                            <label for="uploadBackground" class="btn btn-info shadow-none p-1">
                                <div class="d-flex align-items-center shadow-none text-white">
                                    <i class="bi bi-cloud-arrow-up p-1"></i><div class="d-none d-md-block">Upload</div>
                                </div>
                            </label>
                        </td>
                        @if (Model.IsBackgroundDoc)
                        {
                            var name = Model.providerId + "_background.pdf";
                            <td class="p-2" id="backgroundViewBtn">
                                <a href="~/upload/@name" class="text-decoration-none">
                                    <button type="button" class="p-1 px-2 text-white bg-info rounded border-info d-flex align-items-center h-100">
                                        <i class="bi bi-eye-fill"></i>
                                        <span class="d-none d-md-block ps-2">View</span>
                                    </button>
                                </a>
                            </td>
                        }
                        <td class="p-2 d-none" id="uploadedBackgroundViewBtn">
                            <a href="" class="text-decoration-none">
                                <button type="button" class="p-1 px-2 text-white bg-info rounded border-info d-flex align-items-center h-100">
                                    <i class="bi bi-eye-fill"></i>
                                    <span class="d-none d-md-block ps-2">View</span>
                                </button>
                            </a>
                        </td>
                    </tr>
                    
                    <tr class="p-1">
                        <td class="p-2">
                            <input type="checkbox" class="form-check-input" disabled id="nonDisclosureDocCheck"
                            @if (Model.IsNonDisclosureDoc)
                            {
                                @: checked
                            }
                                   readonly />
                        </td>
                        <td class="p-2 px-3">
                            Non-Disclosure Agreement
                        </td>
                        <td class="p-2">
                            <input type="file" hidden id="nonDisclosure" accept="application/pdf" asp-for="nonDisclosureDoc" />
                            <label for="nonDisclosure" class="btn btn-info shadow-none p-1">
                                <div class="d-flex align-items-center shadow-none text-white">
                                    <i class="bi bi-cloud-arrow-up p-1"></i><div class="d-none d-md-block">Upload</div>
                                </div>
                            </label>
                        </td>
                        @if (Model.IsNonDisclosureDoc)
                        {
                            var name = Model.providerId + "_nonDisclosure.pdf";
                            <td class="p-2" id="nonDisclosureViewBtn">
                                <a href="~/upload/@name" class="text-decoration-none">
                                    <button type="button" class="p-1 px-2 text-white bg-info rounded fileviewbtn border-info d-flex align-items-center h-100">
                                        <i class="bi  bi-eye-fill"></i>
                                        <span class="d-none d-lg-block ps-2">View</span>
                                    </button>
                                </a>
                            </td>
                        }
                        <td class="p-2 d-none" id="uploadedNonDisclosureViewBtn">
                            <a href="" class="text-decoration-none">
                                <button type="button" class="p-1 px-2 text-white bg-info rounded fileviewbtn border-info d-flex align-items-center h-100">
                                    <i class="bi  bi-eye-fill"></i>
                                    <span class="d-none d-lg-block ps-2">View</span>
                                </button>
                            </a>
                        </td>
                    </tr>
                    <tr class="p-1">
                        <td class="p-2">
                            <input type="checkbox" class="form-check-input" disabled id="licenseCheck"
                            @if (Model.IsLicenseDoc)
                            {
                                @: checked
                            }
                                   readonly />
                        </td>
                        <td class="p-2 px-3">
                            License Document
                        </td>
                        <td class="p-2">
                            <input type="file" hidden id="license" accept="application/pdf" asp-for="licenseDoc" />
                            <label for="license" class="btn btn-info shadow-none p-1">
                                <div class="d-flex align-items-center shadow-none text-white">
                                    <i class="bi bi-cloud-arrow-up p-1"></i><div class="d-none d-md-block">Upload</div>
                                </div>
                            </label>
                        </td>
                        @if (Model.IsLicenseDoc)
                        {
                            var name = Model.providerId + "_license.pdf";
                            <td class="p-2" id="licenseViewBtn">
                                <a href="~/upload/@name">
                                    <button type="button" class="p-1 px-2 text-white bg-info rounded fileviewbtn border-info d-flex align-items-center h-100">
                                        <i class="bi  bi-eye-fill"></i>
                                        <span class="d-none d-lg-block ps-2">View</span>
                                    </button>
                                </a>
                            </td>
                        }
                        <td class="p-2 d-none" id="uploadedLicenseViewBtn">
                            <a href="" class="text-decoration-none">
                                <button type="button" class="p-1 px-2 text-white bg-info rounded fileviewbtn border-info d-flex align-items-center h-100">
                                    <i class="bi  bi-eye-fill"></i>
                                    <span class="d-none d-lg-block ps-2">View</span>
                                </button>
                            </a>
                        </td>
                    </tr>
                </table>
            </div>
        </form>
        <input type="file" id="SelectFileToUpload" hidden />
        <hr class="text-muted" style="border : 1px solid black" />
        <div class="d-flex justify-content-end mb-3">

            <div class="mx-1 d-flex">
                <button type="button" class="btn btn-info shadow-none text-white px-3" id="saveDoc">
                    Save
                </button>
            </div>
            <div class="mx-1 d-flex">
                <button type="button" class="btn btn-info shadow-none border-0 text-white bg-danger small px-3 deleteAccountBtn">
                    Delete Account
                </button>
            </div>
        </div>

    </div>

</div>

<script>
    var flag = 0;
    var uploadFlag = 0;
    function dataURLtoBlob(dataURL) {
        var byteString = atob(dataURL.split(",")[1]);
        var mimeString = dataURL.split(",")[0].split(":")[1].split(";")[0];
        var ab = new ArrayBuffer(byteString.length);
        var ia = new Uint8Array(ab);
        for (var i = 0; i < byteString.length; i++) {
            ia[i] = byteString.charCodeAt(i);
        }
        return new Blob([ab], { type: mimeString });
    }

    $('.photoUploadBtn').on('click', function (e) {
        if ($('#photoLabel').html() != "No item selected") {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#uploadedPhotoImg').attr('src', e.target.result);
            };
            reader.readAsDataURL($('#uploadPhoto')[0].files[0]);
            $('#photoError').html("");
            flag = 0;
            uploadFlag = 1;
            $('.uploadedPhotoDiv').removeClass('d-none');
            $('.photoDiv').addClass('d-none');
        }
        else {
            $('#photoError').html("*Please upload photo");
        }
    })

    $('.signUploadBtn').on('click', function (e) {
        if ($('#signLabel').html() != "No item selected") {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#uploadedSignImg').attr('src', e.target.result);
            };
            reader.readAsDataURL($('#uploadSign')[0].files[0]);
            $('#signError').html("");
            flag = 0;
            uploadFlag = 1;
            $('.uploadedSignDiv').removeClass('d-none');
            $('.signDiv').addClass('d-none');
        }
        else {
            $('#signError').html("*Please upload photo");
        }
    })


    $('.deleteAccountBtn').on('click', function (e) {
        e.preventDefault();
        swal.fire({
            title: "Are you sure?",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "Yes",
            closeOnConfirm: false
        }).then(function (result) {
            if (result.value) {
                console.log("Yes Btn");
                $.ajax({
                    url: '/Provider/DeleteAccount',
                    data: { "providerId": $('#providerId').val() },
                    success: function (response) {
                        var link = document.createElement('a');
                        link.href = "/Provider/Provider";
                        link.click();
                    }
                })
            } else {
                // User clicked the cancel button or closed the dialog
                console.log('Cancelled!');
            }
        });
    });


    function convertCanvasToImage() {
        const canvas = document.getElementById("sig-canvas");
        const image = new Image();
        var signName = $('#providerId').val() + "_sign";
        $('#signLabel').html(signName)
        image.src = canvas.toDataURL(); // Convert canvas to data URI
        $('.uploadedSignDiv').removeClass('d-none');
        $('.signDiv').addClass('d-none');
        document.getElementById("uploadedSignImg").src = image.src;
        flag = 1;
        uploadFlag = 1;
    }

    $(document).ready(function () {

        (function fun() {
            window.requestAnimFrame = (function (callback) {
                return window.requestAnimationFrame ||
                    window.webkitRequestAnimationFrame ||
                    window.mozRequestAnimationFrame ||
                    window.oRequestAnimationFrame ||
                    window.msRequestAnimaitonFrame ||
                    function (callback) {
                        window.setTimeout(callback, 1000 / 60);
                    };
            })();

            var canvas = document.getElementById("sig-canvas");
            var ctx = canvas.getContext("2d");
            ctx.strokeStyle = "#222222";
            ctx.lineWidth = 4;

            var drawing = false;
            var mousePos = {
                x: 0,
                y: 0
            };
            var lastPos = mousePos;

            canvas.addEventListener("mousedown", function (e) {
                drawing = true;
                lastPos = getMousePos(canvas, e);
            }, false);

            canvas.addEventListener("mouseup", function (e) {
                drawing = false;
            }, false);

            canvas.addEventListener("mousemove", function (e) {
                mousePos = getMousePos(canvas, e);
            }, false);

            canvas.addEventListener("touchstart", function (e) {

            }, false);

            canvas.addEventListener("touchmove", function (e) {
                var touch = e.touches[0];
                var me = new MouseEvent("mousemove", {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(me);
            }, false);

            canvas.addEventListener("touchstart", function (e) {
                mousePos = getTouchPos(canvas, e);
                var touch = e.touches[0];
                var me = new MouseEvent("mousedown", {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(me);
            }, false);

            canvas.addEventListener("touchend", function (e) {
                var me = new MouseEvent("mouseup", {});
                canvas.dispatchEvent(me);
            }, false);

            function getMousePos(canvasDom, mouseEvent) {
                var rect = canvasDom.getBoundingClientRect();
                return {
                    x: mouseEvent.clientX - rect.left,
                    y: mouseEvent.clientY - rect.top
                }
            }

            function getTouchPos(canvasDom, touchEvent) {
                var rect = canvasDom.getBoundingClientRect();
                return {
                    x: touchEvent.touches[0].clientX - rect.left,
                    y: touchEvent.touches[0].clientY - rect.top
                }
            }

            function renderCanvas() {
                if (drawing) {
                    ctx.moveTo(lastPos.x, lastPos.y);
                    ctx.lineTo(mousePos.x, mousePos.y);
                    ctx.stroke();
                    lastPos = mousePos;
                }
            }

            document.body.addEventListener("touchstart", function (e) {
                if (e.target == canvas) {
                    e.preventDefault();
                }
            }, false);
            document.body.addEventListener("touchend", function (e) {
                if (e.target == canvas) {
                    e.preventDefault();
                }
            }, false);
            document.body.addEventListener("touchmove", function (e) {
                if (e.target == canvas) {
                    e.preventDefault();
                }
            }, false);

            (function drawLoop() {
                requestAnimFrame(drawLoop);
                renderCanvas();
            })();

            function clearCanvas() {
                canvas.width = canvas.width;
            }

            var clearBtn = document.getElementById("sig-clearBtn");
            clearBtn.addEventListener("click", function (e) {
                clearCanvas();
            }, false);

        })();

        var selectedregion = [];

        $('#cancelBtn1').css('display', 'none');
        $('#saveBtn1').css('display', 'none');
        $('#cancelBtn2').css('display', 'none');
        $('#saveBtn2').css('display', 'none');
        $('#cancelBtn3').css('display', 'none');
        $('#saveBtn3').css('display', 'none');

        $('#submitBtn1').on('click', function () {
            $('.data1').each(function () {
                $(this).prop('disabled', false);
            })
            $('#cancelBtn1').css('display', 'flex')
            $('#saveBtn1').css('display', 'flex')
            $(this).css('display', 'none')
        })

        $('#cancelBtn1').on('click', function () {
            $('.data1').each(function () {
                $(this).prop('disabled', true);
            })
            $('#submitBtn1').css('display', 'flex')
            $('#saveBtn1').css('display', 'none')
            $(this).css('display', 'none')
            $('#form1 span').html("");
            $('#form1 input').removeClass("input-validation-error");
        })

        $('#myform1').submit(function (e) {
            e.preventDefault();
            if ($(this).valid()) {

                $.ajax({
                    //type: 'POST',
                    url: '/Provider/UpdatePhysicianInfo',
                    data: $(this).serialize(),
                    success: function (response) {
                        $('.data1').each(function () {
                            $(this).prop('disabled', true);
                        })
                        $('#submitBtn1').css('display', 'flex')
                        $('#saveBtn1').css('display', 'none')
                        $('#cancelBtn1').css('display', 'none')
                        toastr.success("Data updated successfully.");
                    },
                    error: function (xhr, status, error) {
                        // Handle error response
                    }
                });
            }
        });

        $('#submitBtn2').on('click', function () {
            $('.data2').each(function () {
                $(this).prop('disabled', false);
            })
            $('#cancelBtn2').css('display', 'flex')
            $('#saveBtn2').css('display', 'flex')
            $(this).css('display', 'none')
        })

        $('#cancelBtn2').on('click', function () {
            $('.data2').each(function () {
                $(this).prop('disabled', true);
            })
            $('#submitBtn2').css('display', 'flex')
            $('#saveBtn2').css('display', 'none')
            $(this).css('display', 'none')
            $('#myForm2 span').html("");
            $('#myForm2 input').removeClass("input-validation-error");
        })

        $('#myForm2').submit(function (e) {
            e.preventDefault();
            if ($(this).valid()) {
                $.ajax({
                    //type: 'POST',
                    url: '/Provider/UpdateBillingInfo',
                    data: $('#myForm2').serialize(),
                    //data: $(this).serialize(),
                    success: function (response) {
                        $('.data2').each(function () {
                            $(this).prop('disabled', true);
                        })
                        $('#submitBtn2').css('display', 'flex')
                        $('#saveBtn2').css('display', 'none')
                        $('#cancelBtn2').css('display', 'none')
                        toastr.success("Data updated successfully")
                    },
                    error: function (xhr, status, error) {
                        // Handle error response
                    }
                });
            }
        });

        $('#submitBtn3').on('click', function () {
            $('.data3').each(function () {
                $(this).prop('disabled', false);
            })
            $('#myForm3 .toEnable').addClass("btn-info");
            $('#myForm3 .toEnable div').addClass("text-white");
            $('#cancelBtn3').css('display', 'flex')
            $('#saveBtn3').css('display', 'flex')
            $(this).css('display', 'none')
        })

        $('#cancelBtn3').on('click', function () {
            $('.data3').each(function () {
                $(this).prop('disabled', true);
            })
            $('#submitBtn3').css('display', 'flex')
            $('#saveBtn3').css('display', 'none')
            $(this).css('display', 'none')
            $('#myForm3 span').html("");
            $('#myForm3 input').removeClass("input-validation-error");
            $('#myForm3 textarea').removeClass("input-validation-error");
            $('#myForm3 .toEnable').removeClass("btn-info");
            $('#myForm3 .toEnable div').removeClass("text-white");
        })

        $('#saveBtn3').click(function (e) {
            if ($('#photoLabel').text() == "No item selected" && $('#signLabel').text() == "No item selected") {
                uploadFlag = 1;
            }

            if (uploadFlag == 1) {
                e.preventDefault();

                if ($('#myForm3').valid()) {
                    const formData = new FormData();
                    formData.append('photo', $('#uploadPhoto')[0].files[0]);
                    if (flag == 0) {
                        formData.append('signature', $('#uploadSign')[0].files[0]);
                    }
                    else {
                        var blob = dataURLtoBlob($('#uploadedSignImg').attr('src'));
                        formData.append("signature", blob, @Model.providerId+"_sign.png");
                    }
                    formData.append('businessName', $('#businessName').val());
                    formData.append('businessSite', $('#businessSite').val());
                    formData.append('adminnote', $('#adminNote').val());
                    formData.append('providerId', $('#providerId').val());
                    $.ajax({
                        type: 'POST',
                        url: '/Provider/UpdateProfile',
                        data: formData,
                        processData: false,
                        contentType: false,

                        success: function (response) {
                            $('#myForm3 .toEnable').removeClass("btn-info");
                            $('#myForm3 .toEnable div').removeClass("text-white");
                            $('.data3').each(function () {
                                $(this).prop('disabled', true);
                            })
                            $('#submitBtn3').css('display', 'flex')
                            $('#saveBtn3').css('display', 'none')
                            $('#cancelBtn3').css('display', 'none')
                            $('#signError').html("");
                            $('#photoError').html("");
                            toastr.success("Data updated successfully")
                        },
                        error: function (xhr, status, error) {
                            // Handle error response
                        }
                    });
                }
            }
            else {
                $('#signError').html("*Please upload documents.");
            }

        });

        $('#saveDoc').click(function (e) {
            const formData = new FormData();
            formData.append('agreementDoc', $('#uploadAgreement')[0].files[0]);
            formData.append('backgroundDoc', $('#uploadBackground')[0].files[0]);
            formData.append('nonDisclosureDoc', $('#nonDisclosure')[0].files[0]);
            formData.append('licenseDoc', $('#license')[0].files[0]);
            formData.append('providerId', $('#providerId').val());
            $.ajax({
                type: 'POST',
                url: '/Provider/UploadDocuments',
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    toastr.success("Document uploaded successfully.");
                },
                error: function (xhr, status, error) {
                    console.log(error + "At edit provider page saveDoc btn.");
                }
            });
        })

    })

    $('#uploadPhoto').change(function (e) {
        $('#photoLabel').html($(this)[0].files[0].name)
        uploadFlag = 0;
    })

    $('#uploadSign').change(function (e) {
        flag = 0;
        uploadFlag = 0;
        $('#signLabel').html($(this)[0].files[0].name)
    })

    $('#uploadAgreement').change(function (e) {
        $('#agreementDocCheck').prop('checked', true)
        $('#agreementViewBtn').addClass('d-none')
        $('#uploadedAgreementViewBtn').removeClass('d-none')
        var reader = new FileReader();
        reader.onload = function (e) {
            $('#uploadedAgreementViewBtn a').attr('href', e.target.result);
        };
        reader.readAsDataURL($('#uploadAgreement')[0].files[0]);
    })

    $('#uploadBackground').change(function (e) {
        $('#backgroundDocCheck').prop('checked', true)
        $('#backgroundViewBtn').addClass('d-none')
        $('#uploadedBackgroundViewBtn').removeClass('d-none')
        var reader = new FileReader();
        reader.onload = function (e) {
            $('#uploadedBackgroundViewBtn a').attr('href', e.target.result);
        };
        reader.readAsDataURL($('#uploadBackground')[0].files[0]);
    })


    $('#nonDisclosure').change(function (e) {
        $('#nonDisclosureDocCheck').prop('checked', true)
        $('#nonDisclosureViewBtn').addClass('d-none')
        $('#uploadedNonDisclosureViewBtn').removeClass('d-none')
        var reader = new FileReader();
        reader.onload = function (e) {
            $('#uploadedNonDisclosureViewBtn a').attr('href', e.target.result);
        };
        reader.readAsDataURL($('#nonDisclosure')[0].files[0]);
    })


    $('#license').change(function (e) {
        $('#licenseCheck').prop('checked', true)
        $('#licenseViewBtn').addClass('d-none')
        $('#uploadedLicenseViewBtn').removeClass('d-none')
        var reader = new FileReader();
        reader.onload = function (e) {
            $('#uploadedLicenseViewBtn a').attr('href', e.target.result);
        };
        reader.readAsDataURL($('#license')[0].files[0]);
    })

</script>
<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
